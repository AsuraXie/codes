<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>景天软件通用后台管理</title>
    <link href="Public/bootstrap/css/bootstrap.min.css" rel="stylesheet">  
	<script src="Public/jquery-1.11.2.min.js"></script>
    <script src="Public/bootstrap/js/bootstrap.min.js"></script>
    <script src="Public/layer/layer.js"></script>
    <link rel="stylesheet" type="text/css" href="Public/easyui/themes/bootstrap/easyui.css">
    <link rel="stylesheet" type="text/css" href="Public/easyui/themes/icon.css">
    <script type="text/javascript" src="Public/easyui/jquery.easyui.min.js"></script>
  </head>
  <body>
    <table id="userdg"  class="easyui-datagrid" style="width:100%;height:100%"
            url="users/GetAllData"
            method="GET"
            toolbar="#toolbar" pagination="true"
            rownumbers="true" fitColumns="true" singleSelect="true">
        <thead>
            <tr>
                <th data-options="field:'name',width:120">登录名</th>
                <th data-options="field:'login_name',width:120">昵称</th>
                <th data-options="field:'telphone',width:120">联系方式</th>
                <th data-options="field:'zhubie',width:150">所属组</th>
                <th data-options="field:'quanxian',width:350,
                          formatter:function(value,row){
                            return row.name;
                          },
                          editor:{
                            type:'combobox',
                            options:{
                                multiple:'true',
                                valueField:'name',
                                textField:'name',
                                method:'get',
                                url:'data/leftpanel.html',
                                required:true
                            }
                        }">权限</th>
            </tr>
        </thead>
    </table>
    <div id="toolbar">
        <div class="btn-group" role="group">
            <button type="button" class="btn btn-primary" aria-label="Left Align" onclick="newUser()"><span class="glyphicon glyphicon-plus" aria-hidden="true">新增用户</span></button>
            <button type="button" class="btn btn-success" aria-label="Left Align" onclick="groupmanage()"><span class="glyphicon glyphicon-book" aria-hidden="true">用户组管理</span></button>
            <button type="button" class="btn btn-info" aria-label="Left Align" onclick="editUser()"><span class="glyphicon glyphicon-pencil" aria-hidden="true">修改用户信息</span></button>
            <button type="button" class="btn btn-warning" aria-label="Left Align" onclick="deleteUser()"><span class="glyphicon glyphicon-remove" aria-hidden="true">删除用户</span></button>
            <button type="button" class="btn btn-danger" aria-label="Left Align" onclick="viewUser()"><span class="glyphicon glyphicon-search" aria-hidden="true">查看详情</span></button>
        </div>
    </div>
    <div id="userinfo" class="easyui-window" title="  " data-options="modal:true,closed:true" style="width:550px;height:500px;padding:10px;">
        <div class="embed-responsive embed-responsive-16by9" style="width:100%;height:100%">
          <iframe id="centerplace" class="embed-responsive-item" src=""></iframe>
        </div>
    </div>
  </body>
  <script>
    $('#userdg').height($(window).height());
    
    function newUser(){
      $('#centerplace').attr("src","userinfo.html");
      $('#userinfo').window("open");
    }
    
    function groupmanage(){
        $('#centerplace').attr("src","usergroup.html");
        $('#userinfo').window("open");
    }
    
    function editUser(){
      var row=$('#userdg').datagrid('getSelected');
      if(row==null)
      {
        layer.alert("请选择相应修改记录",8);
        return;
      }
      $('#centerplace').attr("src","http://www.baidu.com");
      $('#userinfo').window("open");
      
    }
    
    function CloseWindow(){
       $('#userinfo').window("close");
    }
      
    function deleteUser(){
      var row=$('#userdg').datagrid('getSelected');
      if(row==null)
      {
        layer.alert("请选择相应删除记录",8);
        return;
      }
      $.ajax({
          url:'users/delete',
          data:{
        	  id:row.id
          },
          success:function (data){
              data=eval("("+data+")");
              layer.alert(data.message, function(index){
            	  if(data.success)
                  	  $('#userdg').datagrid("reload");
            	  layer.close(index);
            	});
          }
      });
    }
    
    function viewUser(){
      var row=$('#userdg').datagrid('getSelected');
      if(row==null)
      {
        layer.alert("请选择相应查看记录",8);
        return;
      }
      $('#centerplace').attr("src","showUser.html");
      $('#userinfo').window("open");
    }
  </script>
</html>