<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>景天软件通用后台管理</title>
    <link href="Public/bootstrap/css/bootstrap.min.css" rel="stylesheet">  
	<script src="Public/jquery-1.11.2.min.js"></script>
    <script src="Public/bootstrap/js/bootstrap.min.js"></script>
    <script src="Public/layer/layer.js"></script>
    <link rel="stylesheet" type="text/css" href="Public/easyui/themes/bootstrap/easyui.css">
    <link rel="stylesheet" type="text/css" href="Public/easyui/themes/icon.css">
    <script type="text/javascript" src="Public/easyui/jquery.easyui.min.js"></script>
  </head>
  <body>
	 <table id="usergroup"  class="easyui-datagrid" style="width:100%;height:100%"
	       url="group/GetAllData"
	        method="GET"
	        toolbar="#toolbar" pagination="true"
	        rownumbers="true" fitColumns="true" singleSelect="true">
	    <thead>
	        <tr>
	            <th data-options="field:'id',width:120">序号</th>
	            <th data-options="field:'name',width:120">组名</th>
	            <th data-options="field:'bz',width:120">备注</th>
	        </tr>
	    </thead>
	</table>
	<div id='toolbar' class="btn-group" role="group" aria-label="">
	  <button type="button" class="btn btn-primary glyphicon glyphicon-plus" onclick="addgroup()">新增</button>
	  <button type="button" class="btn btn-success glyphicon glyphicon-pencil" onclick="modifygroup()">修改</button>
	  <button type="button" class="btn btn-warning glyphicon glyphicon-remove" onclick="deletegroup()">删除</button>
	  <button type="button" class="btn btn-danger glyphicon glyphicon-remove" onclick="retry()">关闭</button>
	</div> 
	<div id="addgroup" class="easyui-window" title="  " data-options="modal:true,closed:true" style="width:400px;height:300px;padding:10px;">
		<form>
			<input id="id" hidden="hidden" >
			<span>组名</span>
			<input id="name" type="text" class="form-control" >
			<span>备注</span>
			<textarea id="bz" type="text" class="form-control" rows="5"></textarea>
			<button type="button" class="btn btn-success" style="margin:10px" onclick="saveall()">保存</button>
			<button type="button" class="btn btn-danger" style="margin:10px" onclick="closeall()">关闭</button>
		</form>
    </div>
	<script>
    	$('#usergroup').height($(window).height());
		function retry(){
			window.parent.CloseWindow();
		}
		
		function addgroup(){
			clearForm();
			$('#addgroup').window("open");
		}
		
		function clearForm(){
			$("#id").val("");
			$("#name").val("");
			$("#bz").val("");
		}
		
		function modifygroup(){
		      var row=$('#usergroup').datagrid('getSelected');
		      if(row==null)
		      {
		        layer.alert("请选择相应修改记录",8);
		        return;
		      }
			  $("#id").val(row.id);
			  $("#name").val(row.name);
			  $("#bz").val(row.bz);
		      $('#addgroup').window("open");
		}
		
		function deletegroup(){
		      var row=$('#usergroup').datagrid('getSelected');
		      if(row==null)
		      {
		        layer.alert("请选择相应删除记录",8);
		        return;
		      }
		}
		
		function saveall(){
			$.ajax({
				url:'group/add',
				data:{
					id:$('#id').val(),
					name:$('#name').val(),
					bz:$('#bz').val()
				},
				success:function (data){
					data=eval("("+data+")");
	              	layer.alert(data.message, function(index){
		            	  if(data.success)
		            	  {
		            		  $('#addgroup').window("close");
		            		  $('#usergroup').datagrid("reload");
		            	  }
	            	  }
	            	  layer.close(index);
	            	});
				}
			});
		}
		
		function  closeall(){
			$('#addgroup').window("close");
		}
	</script>
  </body>
</html>